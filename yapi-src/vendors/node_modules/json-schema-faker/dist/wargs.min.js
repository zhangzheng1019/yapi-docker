!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self).wargs=r()}(this,(function(){"use strict";const e=[],r=/$|[!-@[-`{-~][\s\S]*/g,n=Array.isArray,t=function(e){if(""===e)return"";if("false"===e)return!1;const r=Number(e);return 0*r==0?r:e},i=function(r,n,t){let i,o,s,f,a,l,u={};if(void 0!==n)for(a=0,s=n.length;a<s;a++)if(i=n[a],o=r[i],u[i]=t,void 0===o)r[i]=e;else for(l=0,f=o.length;l<f;l++)u[o[l]]=t;return u},o=function(e,r,t,i,o){let s,f,a=i[r],l=void 0===a?-1:a.length;if(l>=0||void 0===o||o(r))for(f=e[r],void 0===f?e[r]=t:n(f)?f.push(t):e[r]=[f,t],s=0;s<l;s++)e[a[s]]=e[r]};var s=function(s,f){let a,l,u,c,d,p=(f=f||{}).unknown,g=function(e){let r,t,i,o,s,f,a,l={};for(r in e)for(s=e[r],t=l[r]=n(s)?s:[s],f=0,o=t.length;f<o;f++)for(i=l[t[f]]=[r],a=0;a<o;a++)f!==a&&i.push(t[a]);return l}(f.alias),h=i(g,f.string,""),v=function(r,n){let t,i,o,s,f,a={};for(t in n)if(o=n[t],i=r[t],a[t]=o,void 0===i)r[t]=e;else for(f=0,s=i.length;f<s;f++)a[i[f]]=o;return a}(g,f.default),y=i(g,f.boolean,!1),b=f.stopEarly,m=[],x={_:m},A=0,O=0,_=s.length;for(;A<_;A++)if(l=s[A],"-"!==l[0]||"-"===l)if(b)for(;A<_;)m.push(s[A++]);else m.push(l);else if("--"===l)for(;++A<_;)m.push(s[A]);else if("-"===l[1])u=l.indexOf("=",2),"n"===l[2]&&"o"===l[3]&&"-"===l[4]?(a=l.slice(5,u>=0?u:void 0),d=!1):u>=0?(a=l.slice(2,u),d=void 0!==y[a]||(void 0===h[a]?t(l.slice(u+1)):l.slice(u+1))):(a=l.slice(2),d=void 0!==y[a]||(_===A+1||"-"===s[A+1][0]?void 0===h[a]||"":void 0===h[a]?t(s[++A]):s[++A])),o(x,a,d,g,p);else for(r.lastIndex=2,c=r.exec(l),u=c.index,d=c[0],O=1;O<u;O++)o(x,a=l[O],O+1<u?void 0===h[a]||l.substring(O+1,O=u)+d:""===d?_===A+1||"-"===s[A+1][0]?void 0===h[a]||"":void 0!==y[a]||(void 0===h[a]?t(s[++A]):s[++A]):void 0!==y[a]||(void 0===h[a]?t(d):d),g,p);for(a in v)void 0===x[a]&&(x[a]=v[a]);for(a in y)void 0===x[a]&&(x[a]=!1);for(a in h)void 0===x[a]&&(x[a]="");return x};const f=e=>`__Symbol@@${e}__`,a=f("QUOTE"),l=f("APOS"),u=f("SPA"),c=/-(\w)/g,d=/^((?!\d)[-~+.\w]+)([=:])(.+?)?$/,p=/(["'])(?:(?!\1).)*\1/,g=['"',"'"," "],h=[/\\"/g,/\\'/g,/\\ /g],v=[a,l,u],y=[a,l,u].map(e=>new RegExp(e,"g"));function b(e){return y.reduce((e,r,n)=>e.replace(r,g[n]),e)}function m(e,r){for(;p.test(e);){const r=e.match(p),n=r[0].substr(1,r[0].length-2);e=e.replace(r[0],g.reduce((e,r,n)=>e.replace(r,v[n]),n))}if(r)for(;e.indexOf(" ")>-1;)e=g.reduce((e,r,n)=>e.replace(r,v[n]),e);return e.split(/\s+/)}function x(e,r){return"function"==typeof r?r(e):e}function A(e){return e.replace(c,(e,r)=>r.toUpperCase())}function O(e,r){return"string"==typeof e?!r&&0!==e.indexOf("--")||-1!==e.indexOf("no-")?e:r?A(e):`--${A(e.substr(2))}`:e.map(e=>O(e,r))}return(e,r,n)=>{if("function"==typeof(r=r||{})&&(n=r,r={}),r.format&&(n=r.format,delete r.format),!Array.isArray(e)){let r;e=function(e){return h.reduce((e,r,n)=>e.replace(r,v[n]),e)}(String(e||""));do{r=e.match(p),r&&(e=e.replace(r[0],m(r[0],!0)))}while(r);e=e.trim().split(/\s+/).map(b).filter(e=>e)}const t=e.indexOf("--"),i=[];t>-1&&(e.slice(t+1).forEach(e=>{i.push(x(e,n))}),e.splice(t+1,e.length)),"string"==typeof r.boolean&&(r.boolean=r.boolean.split("")),"string"==typeof r.string&&(r.string=r.string.split("")),r.boolean&&(r.boolean=O(r.boolean,!0)),r.string&&(r.string=O(r.string,!0)),r.alias&&Object.keys(r.alias).forEach(e=>{r.alias[e]=O(r.alias[e],!0)});const o=s(O(e),r),f=o._.slice(),a={},l={};return delete o._,Object.keys(o).forEach(e=>{const t=o[e];-1!==e.indexOf("-")&&(delete o[e],e=A(e)),r.alias&&r.alias[e]&&0===r.alias[e].indexOf("no-")&&(o[r.alias[e]]&&(o[r.alias[e].substr(3)]=!1),o[e]=!0),Array.isArray(t)&&(o[e]=t.map(e=>x(e,n))),"string"==typeof t&&("="===t.charAt()?o[e]=x(t.substr(1),n):o[e]=x(t,n))}),{_:f.reduce((e,r)=>{const t=r.match(d);return t?"="===t[2]?a[t[1]]=x(t[3]||"",n):l[t[1]]?(Array.isArray(l[t[1]])||(l[t[1]]=[l[t[1]]]),l[t[1]].push(x(t[3]||"",n))):l[t[1]]=x(t[3]||"",n):e.push(x(r,n)),e},[]),raw:i,data:a,flags:o,params:l}}}));
